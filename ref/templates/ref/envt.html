{% extends "base.html" %}
{% block pagetitle %}{{envt.name}}{% endblock %}
{% block maintitle %}Environnement {{envt.name}}{% endblock %}

{%block frequentActionsButtons%}
<a href="{% url 'ref:envt_duplicate' envt.name %}" title="Dupliquer l'environnement">D</a>
{% endblock %}

{%block navigationButtons%}
<a href="{% url 'ref:envts' %}" title="Liste des environnements">↑</a>
{%endblock%}

{% block content %}
{% regroup envt.component_instances.all by model_id as compotype_list %}

<div style='width:auto;'>
	<div class='column' style='min-width: 0px;'>
		<div class='t2'>Généralités</div>
		<div class="metContainer metFreeRect defaultHighlightBackground">
			<table>
				<tr><td>Nom de code</td><td>: {{envt.name}}</td></tr>
				<tr><td>Responsable</td><td>: {{envt.manager}}</td></tr>
				<tr><td>Référencé le</td><td>: {{envt.buildDate}}</td></tr>
				<tr><td>Sera détruit le</td><td>: {{envt.destructionDate}}</td></tr>
				<tr><td>Catégorie</td><td>: {{envt.typology.name}}</td></tr>
		</table>	
		</div>
	</div>
	
	<div class='column' style='max-width:700px; min-width:300px; width=auto;'>
		<div class='t2'>Composants</div>	
		{% for compotype in compotype_list %}
			{% cycle '#004A00' '#61292B' '#180052' '#AD103C' '#004D60' '#1B58B8' '#DE4AAD' as moderncolors silent %}
			{% for compo in compotype.list %}
				
				<div class="metContainer metFreeRect metDefaultBackground">
					<table>
						<tr><td colspan="2" style='font-style: italic;text-align: center;'>{%if compo.instanciates %} {{compo.instanciates.name}} 
						{% else %} {{compo.model.model}} {% endif %} </td></tr>
						{% if compo.name %}
						<tr><td>Nom </td><td>{{compo.name}}</td></tr>
						{% endif %}
						{% if compo.leaf.detail_template %}
							{% include compo.leaf.detail_template  with compo=compo.leaf %}
						{% endif %}
					</table>	
				</div>
			{% endfor %}
		{% endfor %}
	</div>
	
	
	<div class='column' style='width=auto;'>
		<div class='t2'>Représentation</div>
		<img src="{% url 'gph:envt' envt.id %}" alt="environment picture"> 
	</div>
</div>
{% endblock content %}

